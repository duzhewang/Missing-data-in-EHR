---
title: "Submodel 3 with missing data"
date: "7/25/2017"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r,include=FALSE}
setwd("/Users/peterwang/Desktop/Research/missingdata/Project/code/submodel3")
time=system.time(source("submodel3_mcmc_update_case2.R")) 
```

```{r}
##run n_iter=10000 iterations
time
```

```{r}
burnin=5000
##posterior mean
(posterior.mean.v=apply(v_keep[-(1:burnin),],2, mean))
(posterior.mean.E=mean(E_keep[-(1:burnin)]))

```

```{r}
##mean of imputed X
MI.mean.X=apply(X_keep[-(1:burnin),], 2, mean)
##difference with the true X
(diff=MI.mean.X-(SVXYR$X)[R_sim==0])
max(diff)
min(diff)
```

```{r}
##traceplots after burn-in
traceplot(x=as.mcmc(v_keep[-(1:burnin),1]), ylab="v_1")
traceplot(x=as.mcmc(v_keep[-(1:burnin),2]), ylab="v_2")
traceplot(x=as.mcmc(E_keep[-(1:burnin)]), ylab="E")
```








